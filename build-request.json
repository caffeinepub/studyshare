{
  "kind": "build_request",
  "title": "Replace book upload form fields with PDF file upload only",
  "projectName": "StudyHub",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-19",
      "text": "Update the Book upload form in BooksPage.tsx to remove the 'Access Link (URL)' and 'Cover Image URL' fields. Replace them with a PDF file upload input. The selected PDF should be read as Base64 and stored in the backend. Display the selected filename near the upload input. The form should retain fields for title, author, subject, and description. Update the useAddBook mutation in useQueries.ts to pass the pdfBase64 and pdfFileName fields instead of the URL fields.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "In upload book ...use only upload pdf file ."
        ]
      },
      "acceptanceCriteria": [
        "The book upload form no longer shows an 'Access Link (URL)' input field",
        "The book upload form no longer shows a 'Cover Image URL' input field",
        "A PDF file upload input is present in the book upload form",
        "Selecting a PDF file displays the filename near the upload input",
        "The selected PDF file is read as Base64 before submission",
        "Submitting the form sends pdfBase64 and pdfFileName to the backend via useAddBook",
        "Title, author, subject, and description fields remain in the form"
      ]
    },
    {
      "id": "REQ-20",
      "text": "Update the backend Book type in backend/main.mo to replace or supplement the existing accessLink and coverImageUrl fields with optional pdfBase64 and pdfFileName fields (e.g., `pdfBase64: ?Text`, `pdfFileName: ?Text`). Update the addBook function signature accordingly. Update the BookCard component (frontend/src/components/BookCard.tsx) to replace the 'Access Book' button (which opened a URL) with an 'Open Book' button that opens the stored PDF inline in a new browser tab using a Base64 data URI, when a pdfBase64 value is present.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "In upload book ...use only upload pdf file ."
        ]
      },
      "acceptanceCriteria": [
        "The Book type in backend/main.mo includes pdfBase64: ?Text and pdfFileName: ?Text fields",
        "The addBook function accepts pdfBase64 and pdfFileName parameters",
        "BookCard renders an 'Open Book' button when pdfBase64 is present",
        "Clicking 'Open Book' opens the PDF in a new browser tab using a Base64 data URI",
        "The backend migration.mo is updated if the Book state shape changes"
      ]
    }
  ],
  "constraints": [
    "Do not modify any file under frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, or frontend/src/components/ui",
    "Retain all existing book fields (title, author, subject, description) in both the backend type and the upload form"
  ],
  "nonGoals": [
    "Adding external URL/link support back to book uploads",
    "Changing the note upload or share notes PDF functionality",
    "Adding authentication or role-based access for book uploads"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}